{"version":3,"file":"omer.js","sources":["../../../src/omer.ts"],"sourcesContent":["import {\n  HDate,\n  Locale,\n  OmerLang,\n  gematriya,\n  omerEmoji,\n  omerSefira,\n  omerTodayIs,\n} from '@hebcal/hdate';\nimport {Event, flags} from './event';\nimport './locale'; // Adds Hebrew and Ashkenazic translations\n\n/** Represents a day 1-49 of counting the Omer from Pesach to Shavuot */\nexport class OmerEvent extends Event {\n  private readonly weekNumber: number;\n  private readonly daysWithinWeeks: number;\n  readonly omer: number;\n  emoji?: string;\n\n  /**\n   * @param date\n   * @param omerDay\n   */\n  constructor(date: HDate, omerDay: number) {\n    super(date, `Omer ${omerDay}`, flags.OMER_COUNT);\n    if (omerDay < 1 || omerDay > 49) {\n      throw new RangeError(`Invalid Omer day ${omerDay}`);\n    }\n    this.weekNumber = Math.floor((omerDay - 1) / 7) + 1;\n    this.daysWithinWeeks = omerDay % 7 || 7;\n    this.omer = omerDay;\n  }\n  /**\n   * @param lang\n   */\n  sefira(lang = 'en'): string {\n    if (lang !== 'he' && lang !== 'translit') {\n      lang = 'en';\n    }\n    return omerSefira(this.omer, lang as OmerLang);\n  }\n  /**\n   * @todo use gettext()\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  render(locale?: string): string {\n    locale = locale ?? Locale.getLocaleName();\n    if (typeof locale === 'string') {\n      locale = locale.toLowerCase();\n    }\n    const isHebrewLocale =\n      locale === 'he' || locale === 'he-x-nonikud' || locale === 'h';\n    const omer = this.omer;\n    const nth = isHebrewLocale ? gematriya(omer) : Locale.ordinal(omer, locale);\n    return nth + ' ' + Locale.gettext('day of the Omer', locale);\n  }\n  /**\n   * Returns translation of \"Omer day 22\" without ordinal numbers.\n   * @param [locale] Optional locale name (defaults to active locale).\n   */\n  renderBrief(locale?: string): string {\n    return (\n      Locale.gettext('Omer', locale) +\n      ' ' +\n      Locale.gettext('day', locale) +\n      ' ' +\n      this.omer\n    );\n  }\n\n  getEmoji(): string {\n    if (typeof this.emoji === 'string') return this.emoji;\n    return omerEmoji(this.omer);\n  }\n\n  getWeeks(): number {\n    const day7 = this.daysWithinWeeks === 7;\n    return day7 ? this.weekNumber : this.weekNumber - 1;\n  }\n\n  getDaysWithinWeeks(): number {\n    return this.daysWithinWeeks;\n  }\n  /**\n   * @param locale\n   */\n  getTodayIs(locale: string): string {\n    locale = locale ?? Locale.getLocaleName();\n    if (typeof locale === 'string') {\n      locale = locale.toLowerCase();\n    }\n    const omerLang = locale === 'he' || locale === 'he-x-nonikud' ? 'he' : 'en';\n    const str = omerTodayIs(this.omer, omerLang) as string;\n    if (locale === 'he-x-nonikud') {\n      return Locale.hebrewStripNikkud(str);\n    }\n    return str;\n  }\n\n  url(): string {\n    return `https://www.hebcal.com/omer/${this.getDate().getFullYear()}/${this.omer}`;\n  }\n}\n"],"names":[],"mappings":"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"}